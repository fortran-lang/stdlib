submodule (stdlib_stats) stdlib_stats_var

  use, intrinsic:: ieee_arithmetic, only: ieee_value, ieee_quiet_nan
  use stdlib_error, only: error_stop
  use stdlib_optval, only: optval
  implicit none

contains

      module function var_all_1_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_1_rsp_rsp
      module function var_all_2_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_2_rsp_rsp
      module function var_all_3_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_3_rsp_rsp
      module function var_all_4_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_4_rsp_rsp
      module function var_all_5_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_5_rsp_rsp
      module function var_all_6_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_6_rsp_rsp
      module function var_all_7_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_7_rsp_rsp
      module function var_all_8_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_8_rsp_rsp
      module function var_all_9_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_9_rsp_rsp
      module function var_all_10_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_10_rsp_rsp
      module function var_all_11_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_11_rsp_rsp
      module function var_all_12_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_12_rsp_rsp
      module function var_all_13_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_13_rsp_rsp
      module function var_all_14_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_14_rsp_rsp
      module function var_all_15_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_15_rsp_rsp
      module function var_all_1_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_1_rdp_rdp
      module function var_all_2_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_2_rdp_rdp
      module function var_all_3_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_3_rdp_rdp
      module function var_all_4_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_4_rdp_rdp
      module function var_all_5_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_5_rdp_rdp
      module function var_all_6_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_6_rdp_rdp
      module function var_all_7_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_7_rdp_rdp
      module function var_all_8_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_8_rdp_rdp
      module function var_all_9_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_9_rdp_rdp
      module function var_all_10_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_10_rdp_rdp
      module function var_all_11_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_11_rdp_rdp
      module function var_all_12_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_12_rdp_rdp
      module function var_all_13_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_13_rdp_rdp
      module function var_all_14_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_14_rdp_rdp
      module function var_all_15_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_15_rdp_rdp
      module function var_all_1_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_1_rqp_rqp
      module function var_all_2_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_2_rqp_rqp
      module function var_all_3_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_3_rqp_rqp
      module function var_all_4_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_4_rqp_rqp
      module function var_all_5_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_5_rqp_rqp
      module function var_all_6_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_6_rqp_rqp
      module function var_all_7_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_7_rqp_rqp
      module function var_all_8_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_8_rqp_rqp
      module function var_all_9_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_9_rqp_rqp
      module function var_all_10_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_10_rqp_rqp
      module function var_all_11_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_11_rqp_rqp
      module function var_all_12_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_12_rqp_rqp
      module function var_all_13_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_13_rqp_rqp
      module function var_all_14_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_14_rqp_rqp
      module function var_all_15_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum((x - mean)**2) / (n - merge(1, 0 , optval(corrected, .true.)))

      end function var_all_15_rqp_rqp
      module function var_all_1_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_csp_csp
      module function var_all_2_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_csp_csp
      module function var_all_3_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_csp_csp
      module function var_all_4_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_csp_csp
      module function var_all_5_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_csp_csp
      module function var_all_6_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_csp_csp
      module function var_all_7_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_csp_csp
      module function var_all_8_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_csp_csp
      module function var_all_9_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_csp_csp
      module function var_all_10_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_csp_csp
      module function var_all_11_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_csp_csp
      module function var_all_12_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_csp_csp
      module function var_all_13_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_csp_csp
      module function var_all_14_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_csp_csp
      module function var_all_15_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), sp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_csp_csp
      module function var_all_1_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_cdp_cdp
      module function var_all_2_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_cdp_cdp
      module function var_all_3_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_cdp_cdp
      module function var_all_4_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_cdp_cdp
      module function var_all_5_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_cdp_cdp
      module function var_all_6_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_cdp_cdp
      module function var_all_7_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_cdp_cdp
      module function var_all_8_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_cdp_cdp
      module function var_all_9_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_cdp_cdp
      module function var_all_10_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_cdp_cdp
      module function var_all_11_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_cdp_cdp
      module function var_all_12_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_cdp_cdp
      module function var_all_13_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_cdp_cdp
      module function var_all_14_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_cdp_cdp
      module function var_all_15_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_cdp_cdp
      module function var_all_1_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_cqp_cqp
      module function var_all_2_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_cqp_cqp
      module function var_all_3_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_cqp_cqp
      module function var_all_4_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_cqp_cqp
      module function var_all_5_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_cqp_cqp
      module function var_all_6_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_cqp_cqp
      module function var_all_7_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_cqp_cqp
      module function var_all_8_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_cqp_cqp
      module function var_all_9_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_cqp_cqp
      module function var_all_10_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_cqp_cqp
      module function var_all_11_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_cqp_cqp
      module function var_all_12_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_cqp_cqp
      module function var_all_13_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_cqp_cqp
      module function var_all_14_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_cqp_cqp
      module function var_all_15_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), qp)
        mean = sum(x) / n

          res = sum(abs(x - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_cqp_cqp


      module function var_all_1_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_iint8_dp
      module function var_all_2_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_iint8_dp
      module function var_all_3_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_iint8_dp
      module function var_all_4_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_iint8_dp
      module function var_all_5_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_iint8_dp
      module function var_all_6_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_iint8_dp
      module function var_all_7_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_iint8_dp
      module function var_all_8_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_iint8_dp
      module function var_all_9_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_iint8_dp
      module function var_all_10_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_iint8_dp
      module function var_all_11_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_iint8_dp
      module function var_all_12_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_iint8_dp
      module function var_all_13_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_iint8_dp
      module function var_all_14_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_iint8_dp
      module function var_all_15_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_iint8_dp
      module function var_all_1_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_iint16_dp
      module function var_all_2_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_iint16_dp
      module function var_all_3_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_iint16_dp
      module function var_all_4_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_iint16_dp
      module function var_all_5_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_iint16_dp
      module function var_all_6_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_iint16_dp
      module function var_all_7_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_iint16_dp
      module function var_all_8_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_iint16_dp
      module function var_all_9_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_iint16_dp
      module function var_all_10_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_iint16_dp
      module function var_all_11_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_iint16_dp
      module function var_all_12_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_iint16_dp
      module function var_all_13_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_iint16_dp
      module function var_all_14_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_iint16_dp
      module function var_all_15_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_iint16_dp
      module function var_all_1_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_iint32_dp
      module function var_all_2_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_iint32_dp
      module function var_all_3_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_iint32_dp
      module function var_all_4_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_iint32_dp
      module function var_all_5_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_iint32_dp
      module function var_all_6_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_iint32_dp
      module function var_all_7_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_iint32_dp
      module function var_all_8_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_iint32_dp
      module function var_all_9_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_iint32_dp
      module function var_all_10_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_iint32_dp
      module function var_all_11_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_iint32_dp
      module function var_all_12_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_iint32_dp
      module function var_all_13_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_iint32_dp
      module function var_all_14_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_iint32_dp
      module function var_all_15_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_iint32_dp
      module function var_all_1_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_1_iint64_dp
      module function var_all_2_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_2_iint64_dp
      module function var_all_3_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_3_iint64_dp
      module function var_all_4_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_4_iint64_dp
      module function var_all_5_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_5_iint64_dp
      module function var_all_6_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_6_iint64_dp
      module function var_all_7_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_7_iint64_dp
      module function var_all_8_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_8_iint64_dp
      module function var_all_9_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_9_iint64_dp
      module function var_all_10_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_10_iint64_dp
      module function var_all_11_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_11_iint64_dp
      module function var_all_12_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_12_iint64_dp
      module function var_all_13_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_13_iint64_dp
      module function var_all_14_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_14_iint64_dp
      module function var_all_15_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        n = real(size(x, kind = int64), dp)
        mean = sum(real(x, dp)) / n

        res = sum((real(x, dp) - mean)**2) / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_all_15_iint64_dp


      module function var_1_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        integer :: i
        real(sp) :: n
        real(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_rsp_rsp
      module function var_2_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_rsp_rsp
      module function var_3_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_rsp_rsp
      module function var_4_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_rsp_rsp
      module function var_5_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_rsp_rsp
      module function var_6_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_rsp_rsp
      module function var_7_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_rsp_rsp
      module function var_8_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_rsp_rsp
      module function var_9_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_rsp_rsp
      module function var_10_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_rsp_rsp
      module function var_11_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_rsp_rsp
      module function var_12_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_rsp_rsp
      module function var_13_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_rsp_rsp
      module function var_14_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_rsp_rsp
      module function var_15_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(sp) :: n
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_rsp_rsp
      module function var_1_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_rdp_rdp
      module function var_2_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_rdp_rdp
      module function var_3_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_rdp_rdp
      module function var_4_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_rdp_rdp
      module function var_5_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_rdp_rdp
      module function var_6_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_rdp_rdp
      module function var_7_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_rdp_rdp
      module function var_8_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_rdp_rdp
      module function var_9_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_rdp_rdp
      module function var_10_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_rdp_rdp
      module function var_11_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_rdp_rdp
      module function var_12_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_rdp_rdp
      module function var_13_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_rdp_rdp
      module function var_14_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_rdp_rdp
      module function var_15_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_rdp_rdp
      module function var_1_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        integer :: i
        real(qp) :: n
        real(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_rqp_rqp
      module function var_2_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_rqp_rqp
      module function var_3_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_rqp_rqp
      module function var_4_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_rqp_rqp
      module function var_5_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_rqp_rqp
      module function var_6_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_rqp_rqp
      module function var_7_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_rqp_rqp
      module function var_8_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_rqp_rqp
      module function var_9_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_rqp_rqp
      module function var_10_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_rqp_rqp
      module function var_11_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_rqp_rqp
      module function var_12_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_rqp_rqp
      module function var_13_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_rqp_rqp
      module function var_14_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_rqp_rqp
      module function var_15_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(qp) :: n
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + (x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_rqp_rqp
      module function var_1_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res

        integer :: i
        real(sp) :: n
        complex(sp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_csp_csp
      module function var_2_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_csp_csp
      module function var_3_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_csp_csp
      module function var_4_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_csp_csp
      module function var_5_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_csp_csp
      module function var_6_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_csp_csp
      module function var_7_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_csp_csp
      module function var_8_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_csp_csp
      module function var_9_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_csp_csp
      module function var_10_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_csp_csp
      module function var_11_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_csp_csp
      module function var_12_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_csp_csp
      module function var_13_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_csp_csp
      module function var_14_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_csp_csp
      module function var_15_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(sp) :: n
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._sp, ieee_quiet_nan)
          return
        end if

        res = 0._sp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_csp_csp
      module function var_1_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        complex(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_cdp_cdp
      module function var_2_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_cdp_cdp
      module function var_3_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_cdp_cdp
      module function var_4_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_cdp_cdp
      module function var_5_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_cdp_cdp
      module function var_6_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_cdp_cdp
      module function var_7_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_cdp_cdp
      module function var_8_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_cdp_cdp
      module function var_9_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_cdp_cdp
      module function var_10_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_cdp_cdp
      module function var_11_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_cdp_cdp
      module function var_12_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_cdp_cdp
      module function var_13_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_cdp_cdp
      module function var_14_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_cdp_cdp
      module function var_15_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_cdp_cdp
      module function var_1_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res

        integer :: i
        real(qp) :: n
        complex(qp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_cqp_cqp
      module function var_2_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_cqp_cqp
      module function var_3_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_cqp_cqp
      module function var_4_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_cqp_cqp
      module function var_5_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_cqp_cqp
      module function var_6_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_cqp_cqp
      module function var_7_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_cqp_cqp
      module function var_8_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_cqp_cqp
      module function var_9_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_cqp_cqp
      module function var_10_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_cqp_cqp
      module function var_11_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_cqp_cqp
      module function var_12_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_cqp_cqp
      module function var_13_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_cqp_cqp
      module function var_14_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_cqp_cqp
      module function var_15_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(qp) :: n
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._qp, ieee_quiet_nan)
          return
        end if

        res = 0._qp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(x, dim) / n
            do i = 1, size(x, dim)
                res = res + abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_cqp_cqp


      module function var_1_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_iint8_dp
      module function var_2_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_iint8_dp
      module function var_3_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_iint8_dp
      module function var_4_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_iint8_dp
      module function var_5_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_iint8_dp
      module function var_6_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_iint8_dp
      module function var_7_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_iint8_dp
      module function var_8_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_iint8_dp
      module function var_9_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_iint8_dp
      module function var_10_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_iint8_dp
      module function var_11_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_iint8_dp
      module function var_12_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_iint8_dp
      module function var_13_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_iint8_dp
      module function var_14_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_iint8_dp
      module function var_15_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_iint8_dp
      module function var_1_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_iint16_dp
      module function var_2_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_iint16_dp
      module function var_3_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_iint16_dp
      module function var_4_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_iint16_dp
      module function var_5_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_iint16_dp
      module function var_6_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_iint16_dp
      module function var_7_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_iint16_dp
      module function var_8_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_iint16_dp
      module function var_9_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_iint16_dp
      module function var_10_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_iint16_dp
      module function var_11_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_iint16_dp
      module function var_12_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_iint16_dp
      module function var_13_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_iint16_dp
      module function var_14_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_iint16_dp
      module function var_15_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_iint16_dp
      module function var_1_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_iint32_dp
      module function var_2_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_iint32_dp
      module function var_3_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_iint32_dp
      module function var_4_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_iint32_dp
      module function var_5_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_iint32_dp
      module function var_6_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_iint32_dp
      module function var_7_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_iint32_dp
      module function var_8_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_iint32_dp
      module function var_9_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_iint32_dp
      module function var_10_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_iint32_dp
      module function var_11_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_iint32_dp
      module function var_12_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_iint32_dp
      module function var_13_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_iint32_dp
      module function var_14_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_iint32_dp
      module function var_15_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_iint32_dp
      module function var_1_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_1_iint64_dp
      module function var_2_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_2_iint64_dp
      module function var_3_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_3_iint64_dp
      module function var_4_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_4_iint64_dp
      module function var_5_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_5_iint64_dp
      module function var_6_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_6_iint64_dp
      module function var_7_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_7_iint64_dp
      module function var_8_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_8_iint64_dp
      module function var_9_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_9_iint64_dp
      module function var_10_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_10_iint64_dp
      module function var_11_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_11_iint64_dp
      module function var_12_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_12_iint64_dp
      module function var_13_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_13_iint64_dp
      module function var_14_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_14_iint64_dp
      module function var_15_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in), optional :: mask
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        if (.not.optval(mask, .true.)) then
          res = ieee_value(1._dp, ieee_quiet_nan)
          return
        end if

        res = 0._dp
        select case(dim)
          case(1)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(2)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(3)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(4)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(5)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(6)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(7)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(8)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(9)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2
            end do
          case(10)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2
            end do
          case(11)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2
            end do
          case(12)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2
            end do
          case(13)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2
            end do
          case(14)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2
            end do
          case(15)
            n = size(x, dim)
            mean = sum(real(x, dp), dim) / n
            do i = 1, size(x, dim)
              res = res + (real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, optval(corrected, .true.)))

      end function var_15_iint64_dp


      module function var_mask_all_1_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_rsp_rsp
      module function var_mask_all_2_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_rsp_rsp
      module function var_mask_all_3_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_rsp_rsp
      module function var_mask_all_4_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_rsp_rsp
      module function var_mask_all_5_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_rsp_rsp
      module function var_mask_all_6_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_rsp_rsp
      module function var_mask_all_7_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_rsp_rsp
      module function var_mask_all_8_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_rsp_rsp
      module function var_mask_all_9_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_rsp_rsp
      module function var_mask_all_10_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_rsp_rsp
      module function var_mask_all_11_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_rsp_rsp
      module function var_mask_all_12_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_rsp_rsp
      module function var_mask_all_13_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_rsp_rsp
      module function var_mask_all_14_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_rsp_rsp
      module function var_mask_all_15_rsp_rsp(x, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        real(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_rsp_rsp
      module function var_mask_all_1_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_rdp_rdp
      module function var_mask_all_2_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_rdp_rdp
      module function var_mask_all_3_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_rdp_rdp
      module function var_mask_all_4_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_rdp_rdp
      module function var_mask_all_5_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_rdp_rdp
      module function var_mask_all_6_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_rdp_rdp
      module function var_mask_all_7_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_rdp_rdp
      module function var_mask_all_8_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_rdp_rdp
      module function var_mask_all_9_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_rdp_rdp
      module function var_mask_all_10_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_rdp_rdp
      module function var_mask_all_11_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_rdp_rdp
      module function var_mask_all_12_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_rdp_rdp
      module function var_mask_all_13_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_rdp_rdp
      module function var_mask_all_14_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_rdp_rdp
      module function var_mask_all_15_rdp_rdp(x, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        real(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_rdp_rdp
      module function var_mask_all_1_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_rqp_rqp
      module function var_mask_all_2_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_rqp_rqp
      module function var_mask_all_3_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_rqp_rqp
      module function var_mask_all_4_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_rqp_rqp
      module function var_mask_all_5_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_rqp_rqp
      module function var_mask_all_6_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_rqp_rqp
      module function var_mask_all_7_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_rqp_rqp
      module function var_mask_all_8_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_rqp_rqp
      module function var_mask_all_9_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_rqp_rqp
      module function var_mask_all_10_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_rqp_rqp
      module function var_mask_all_11_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_rqp_rqp
      module function var_mask_all_12_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_rqp_rqp
      module function var_mask_all_13_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_rqp_rqp
      module function var_mask_all_14_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_rqp_rqp
      module function var_mask_all_15_rqp_rqp(x, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        real(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum((x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_rqp_rqp
      module function var_mask_all_1_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_csp_csp
      module function var_mask_all_2_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_csp_csp
      module function var_mask_all_3_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_csp_csp
      module function var_mask_all_4_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_csp_csp
      module function var_mask_all_5_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_csp_csp
      module function var_mask_all_6_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_csp_csp
      module function var_mask_all_7_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_csp_csp
      module function var_mask_all_8_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_csp_csp
      module function var_mask_all_9_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_csp_csp
      module function var_mask_all_10_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_csp_csp
      module function var_mask_all_11_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_csp_csp
      module function var_mask_all_12_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_csp_csp
      module function var_mask_all_13_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_csp_csp
      module function var_mask_all_14_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_csp_csp
      module function var_mask_all_15_csp_csp(x, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        real(sp) :: n
        complex(sp) :: mean

        n = real(count(mask, kind = int64), sp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_csp_csp
      module function var_mask_all_1_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_cdp_cdp
      module function var_mask_all_2_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_cdp_cdp
      module function var_mask_all_3_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_cdp_cdp
      module function var_mask_all_4_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_cdp_cdp
      module function var_mask_all_5_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_cdp_cdp
      module function var_mask_all_6_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_cdp_cdp
      module function var_mask_all_7_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_cdp_cdp
      module function var_mask_all_8_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_cdp_cdp
      module function var_mask_all_9_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_cdp_cdp
      module function var_mask_all_10_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_cdp_cdp
      module function var_mask_all_11_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_cdp_cdp
      module function var_mask_all_12_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_cdp_cdp
      module function var_mask_all_13_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_cdp_cdp
      module function var_mask_all_14_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_cdp_cdp
      module function var_mask_all_15_cdp_cdp(x, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n
        complex(dp) :: mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_cdp_cdp
      module function var_mask_all_1_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_cqp_cqp
      module function var_mask_all_2_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_cqp_cqp
      module function var_mask_all_3_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_cqp_cqp
      module function var_mask_all_4_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_cqp_cqp
      module function var_mask_all_5_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_cqp_cqp
      module function var_mask_all_6_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_cqp_cqp
      module function var_mask_all_7_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_cqp_cqp
      module function var_mask_all_8_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_cqp_cqp
      module function var_mask_all_9_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_cqp_cqp
      module function var_mask_all_10_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_cqp_cqp
      module function var_mask_all_11_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_cqp_cqp
      module function var_mask_all_12_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_cqp_cqp
      module function var_mask_all_13_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_cqp_cqp
      module function var_mask_all_14_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_cqp_cqp
      module function var_mask_all_15_cqp_cqp(x, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        real(qp) :: n
        complex(qp) :: mean

        n = real(count(mask, kind = int64), qp)
        mean = sum(x, mask) / n

          res = sum(abs(x - mean)**2, mask) / (n -&
                merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_cqp_cqp


      module function var_mask_all_1_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_iint8_dp
      module function var_mask_all_2_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_iint8_dp
      module function var_mask_all_3_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_iint8_dp
      module function var_mask_all_4_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_iint8_dp
      module function var_mask_all_5_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_iint8_dp
      module function var_mask_all_6_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_iint8_dp
      module function var_mask_all_7_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_iint8_dp
      module function var_mask_all_8_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_iint8_dp
      module function var_mask_all_9_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_iint8_dp
      module function var_mask_all_10_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_iint8_dp
      module function var_mask_all_11_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_iint8_dp
      module function var_mask_all_12_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_iint8_dp
      module function var_mask_all_13_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_iint8_dp
      module function var_mask_all_14_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_iint8_dp
      module function var_mask_all_15_iint8_dp(x, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_iint8_dp
      module function var_mask_all_1_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_iint16_dp
      module function var_mask_all_2_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_iint16_dp
      module function var_mask_all_3_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_iint16_dp
      module function var_mask_all_4_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_iint16_dp
      module function var_mask_all_5_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_iint16_dp
      module function var_mask_all_6_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_iint16_dp
      module function var_mask_all_7_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_iint16_dp
      module function var_mask_all_8_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_iint16_dp
      module function var_mask_all_9_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_iint16_dp
      module function var_mask_all_10_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_iint16_dp
      module function var_mask_all_11_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_iint16_dp
      module function var_mask_all_12_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_iint16_dp
      module function var_mask_all_13_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_iint16_dp
      module function var_mask_all_14_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_iint16_dp
      module function var_mask_all_15_iint16_dp(x, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_iint16_dp
      module function var_mask_all_1_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_iint32_dp
      module function var_mask_all_2_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_iint32_dp
      module function var_mask_all_3_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_iint32_dp
      module function var_mask_all_4_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_iint32_dp
      module function var_mask_all_5_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_iint32_dp
      module function var_mask_all_6_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_iint32_dp
      module function var_mask_all_7_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_iint32_dp
      module function var_mask_all_8_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_iint32_dp
      module function var_mask_all_9_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_iint32_dp
      module function var_mask_all_10_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_iint32_dp
      module function var_mask_all_11_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_iint32_dp
      module function var_mask_all_12_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_iint32_dp
      module function var_mask_all_13_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_iint32_dp
      module function var_mask_all_14_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_iint32_dp
      module function var_mask_all_15_iint32_dp(x, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_iint32_dp
      module function var_mask_all_1_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:)
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_1_iint64_dp
      module function var_mask_all_2_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:)
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_2_iint64_dp
      module function var_mask_all_3_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:)
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_3_iint64_dp
      module function var_mask_all_4_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_4_iint64_dp
      module function var_mask_all_5_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_5_iint64_dp
      module function var_mask_all_6_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_6_iint64_dp
      module function var_mask_all_7_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_7_iint64_dp
      module function var_mask_all_8_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_8_iint64_dp
      module function var_mask_all_9_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_9_iint64_dp
      module function var_mask_all_10_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_10_iint64_dp
      module function var_mask_all_11_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_11_iint64_dp
      module function var_mask_all_12_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_12_iint64_dp
      module function var_mask_all_13_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_13_iint64_dp
      module function var_mask_all_14_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_14_iint64_dp
      module function var_mask_all_15_iint64_dp(x, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        real(dp) :: n, mean

        n = real(count(mask, kind = int64), dp)
        mean = sum(real(x, dp), mask) / n

        res = sum((real(x, dp) - mean)**2, mask) / (n -&
              merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_all_15_iint64_dp


      module function var_mask_1_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        integer :: i
        real(sp) :: n
        real(sp) :: mean

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i) - mean)**2,&
                                  0._sp,&
                                  mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_rsp_rsp
      module function var_mask_2_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_rsp_rsp
      module function var_mask_3_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_rsp_rsp
      module function var_mask_4_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_rsp_rsp
      module function var_mask_5_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_rsp_rsp
      module function var_mask_6_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_rsp_rsp
      module function var_mask_7_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_rsp_rsp
      module function var_mask_8_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_rsp_rsp
      module function var_mask_9_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_rsp_rsp
      module function var_mask_10_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_rsp_rsp
      module function var_mask_11_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_rsp_rsp
      module function var_mask_12_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_rsp_rsp
      module function var_mask_13_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_rsp_rsp
      module function var_mask_14_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_rsp_rsp
      module function var_mask_15_rsp_rsp(x, dim, mask, corrected) result(res)
        real(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_rsp_rsp
      module function var_mask_1_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i) - mean)**2,&
                                  0._dp,&
                                  mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_rdp_rdp
      module function var_mask_2_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_rdp_rdp
      module function var_mask_3_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_rdp_rdp
      module function var_mask_4_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_rdp_rdp
      module function var_mask_5_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_rdp_rdp
      module function var_mask_6_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_rdp_rdp
      module function var_mask_7_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_rdp_rdp
      module function var_mask_8_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_rdp_rdp
      module function var_mask_9_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_rdp_rdp
      module function var_mask_10_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_rdp_rdp
      module function var_mask_11_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_rdp_rdp
      module function var_mask_12_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_rdp_rdp
      module function var_mask_13_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_rdp_rdp
      module function var_mask_14_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_rdp_rdp
      module function var_mask_15_rdp_rdp(x, dim, mask, corrected) result(res)
        real(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_rdp_rdp
      module function var_mask_1_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        integer :: i
        real(qp) :: n
        real(qp) :: mean

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i) - mean)**2,&
                                  0._qp,&
                                  mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_rqp_rqp
      module function var_mask_2_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_rqp_rqp
      module function var_mask_3_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_rqp_rqp
      module function var_mask_4_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_rqp_rqp
      module function var_mask_5_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_rqp_rqp
      module function var_mask_6_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_rqp_rqp
      module function var_mask_7_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_rqp_rqp
      module function var_mask_8_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_rqp_rqp
      module function var_mask_9_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_rqp_rqp
      module function var_mask_10_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_rqp_rqp
      module function var_mask_11_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_rqp_rqp
      module function var_mask_12_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_rqp_rqp
      module function var_mask_13_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_rqp_rqp
      module function var_mask_14_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_rqp_rqp
      module function var_mask_15_rqp_rqp(x, dim, mask, corrected) result(res)
        real(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( (x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_rqp_rqp
      module function var_mask_1_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(sp) :: res

        integer :: i
        real(sp) :: n
        complex(sp) :: mean

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i) - mean)**2,&
                                  0._sp,&
                                  mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_csp_csp
      module function var_mask_2_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_csp_csp
      module function var_mask_3_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_csp_csp
      module function var_mask_4_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_csp_csp
      module function var_mask_5_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_csp_csp
      module function var_mask_6_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_csp_csp
      module function var_mask_7_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_csp_csp
      module function var_mask_8_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_csp_csp
      module function var_mask_9_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_csp_csp
      module function var_mask_10_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_csp_csp
      module function var_mask_11_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_csp_csp
      module function var_mask_12_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_csp_csp
      module function var_mask_13_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_csp_csp
      module function var_mask_14_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_csp_csp
      module function var_mask_15_csp_csp(x, dim, mask, corrected) result(res)
        complex(sp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(sp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(sp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        complex(sp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._sp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._sp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_csp_csp
      module function var_mask_1_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        complex(dp) :: mean

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i) - mean)**2,&
                                  0._dp,&
                                  mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_cdp_cdp
      module function var_mask_2_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_cdp_cdp
      module function var_mask_3_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_cdp_cdp
      module function var_mask_4_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_cdp_cdp
      module function var_mask_5_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_cdp_cdp
      module function var_mask_6_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_cdp_cdp
      module function var_mask_7_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_cdp_cdp
      module function var_mask_8_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_cdp_cdp
      module function var_mask_9_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_cdp_cdp
      module function var_mask_10_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_cdp_cdp
      module function var_mask_11_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_cdp_cdp
      module function var_mask_12_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_cdp_cdp
      module function var_mask_13_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_cdp_cdp
      module function var_mask_14_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_cdp_cdp
      module function var_mask_15_cdp_cdp(x, dim, mask, corrected) result(res)
        complex(dp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        complex(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._dp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_cdp_cdp
      module function var_mask_1_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(qp) :: res

        integer :: i
        real(qp) :: n
        complex(qp) :: mean

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i) - mean)**2,&
                                  0._qp,&
                                  mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_cqp_cqp
      module function var_mask_2_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_cqp_cqp
      module function var_mask_3_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_cqp_cqp
      module function var_mask_4_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_cqp_cqp
      module function var_mask_5_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_cqp_cqp
      module function var_mask_6_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_cqp_cqp
      module function var_mask_7_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_cqp_cqp
      module function var_mask_8_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_cqp_cqp
      module function var_mask_9_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_cqp_cqp
      module function var_mask_10_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_cqp_cqp
      module function var_mask_11_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_cqp_cqp
      module function var_mask_12_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_cqp_cqp
      module function var_mask_13_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_cqp_cqp
      module function var_mask_14_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_cqp_cqp
      module function var_mask_15_cqp_cqp(x, dim, mask, corrected) result(res)
        complex(qp), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(qp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(qp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        complex(qp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x,&
            & 3), size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._qp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(x, dim, mask) / n
            do i = 1, size(x, dim)
                res = res + merge( abs(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i) - mean)**2,&
                                  0._qp,&
                                  mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_cqp_cqp


      module function var_mask_1_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i), dp) - mean)**2,&
                                  0._dp, mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_iint8_dp
      module function var_mask_2_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :), dp) - mean)**2,&
                                  0._dp, mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i), dp) - mean)**2,&
                                  0._dp, mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_iint8_dp
      module function var_mask_3_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_iint8_dp
      module function var_mask_4_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_iint8_dp
      module function var_mask_5_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_iint8_dp
      module function var_mask_6_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_iint8_dp
      module function var_mask_7_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_iint8_dp
      module function var_mask_8_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_iint8_dp
      module function var_mask_9_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_iint8_dp
      module function var_mask_10_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_iint8_dp
      module function var_mask_11_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_iint8_dp
      module function var_mask_12_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_iint8_dp
      module function var_mask_13_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_iint8_dp
      module function var_mask_14_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_iint8_dp
      module function var_mask_15_iint8_dp(x, dim, mask, corrected) result(res)
        integer(int8), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_iint8_dp
      module function var_mask_1_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i), dp) - mean)**2,&
                                  0._dp, mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_iint16_dp
      module function var_mask_2_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :), dp) - mean)**2,&
                                  0._dp, mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i), dp) - mean)**2,&
                                  0._dp, mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_iint16_dp
      module function var_mask_3_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_iint16_dp
      module function var_mask_4_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_iint16_dp
      module function var_mask_5_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_iint16_dp
      module function var_mask_6_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_iint16_dp
      module function var_mask_7_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_iint16_dp
      module function var_mask_8_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_iint16_dp
      module function var_mask_9_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_iint16_dp
      module function var_mask_10_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_iint16_dp
      module function var_mask_11_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_iint16_dp
      module function var_mask_12_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_iint16_dp
      module function var_mask_13_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_iint16_dp
      module function var_mask_14_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_iint16_dp
      module function var_mask_15_iint16_dp(x, dim, mask, corrected) result(res)
        integer(int16), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_iint16_dp
      module function var_mask_1_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i), dp) - mean)**2,&
                                  0._dp, mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_iint32_dp
      module function var_mask_2_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :), dp) - mean)**2,&
                                  0._dp, mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i), dp) - mean)**2,&
                                  0._dp, mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_iint32_dp
      module function var_mask_3_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_iint32_dp
      module function var_mask_4_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_iint32_dp
      module function var_mask_5_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_iint32_dp
      module function var_mask_6_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_iint32_dp
      module function var_mask_7_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_iint32_dp
      module function var_mask_8_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_iint32_dp
      module function var_mask_9_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_iint32_dp
      module function var_mask_10_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_iint32_dp
      module function var_mask_11_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_iint32_dp
      module function var_mask_12_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_iint32_dp
      module function var_mask_13_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_iint32_dp
      module function var_mask_14_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_iint32_dp
      module function var_mask_15_iint32_dp(x, dim, mask, corrected) result(res)
        integer(int32), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_iint32_dp
      module function var_mask_1_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:)
        logical, intent(in), optional :: corrected
        real(dp) :: res

        integer :: i
        real(dp) :: n
        real(dp) :: mean

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i), dp) - mean)**2,&
                                  0._dp, mask(i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_1_iint64_dp
      module function var_mask_2_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :), dp) - mean)**2,&
                                  0._dp, mask(i, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i), dp) - mean)**2,&
                                  0._dp, mask(:, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_2_iint64_dp
      module function var_mask_3_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_3_iint64_dp
      module function var_mask_4_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_4_iint64_dp
      module function var_mask_5_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_5_iint64_dp
      module function var_mask_6_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_6_iint64_dp
      module function var_mask_7_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_7_iint64_dp
      module function var_mask_8_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_8_iint64_dp
      module function var_mask_9_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_9_iint64_dp
      module function var_mask_10_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_10_iint64_dp
      module function var_mask_11_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_11_iint64_dp
      module function var_mask_12_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_12_iint64_dp
      module function var_mask_13_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_13_iint64_dp
      module function var_mask_14_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_14_iint64_dp
      module function var_mask_15_iint64_dp(x, dim, mask, corrected) result(res)
        integer(int64), intent(in) :: x(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        integer, intent(in) :: dim
        logical, intent(in) :: mask(:,:,:,:,:,:,:,:,:,:,:,:,:,:,:)
        logical, intent(in), optional :: corrected
        real(dp) :: res(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        integer :: i
        real(dp) :: n(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))
        real(dp) :: mean(merge(size(x, 1), size(x, 2), mask=1<dim), merge(size(x, 2), size(x, 3), mask=2<dim), merge(size(x, 3),&
            & size(x, 4), mask=3<dim), merge(size(x, 4), size(x, 5), mask=4<dim), merge(size(x, 5), size(x, 6), mask=5<dim),&
            & merge(size(x, 6), size(x, 7), mask=6<dim), merge(size(x, 7), size(x, 8), mask=7<dim), merge(size(x, 8), size(x, 9),&
            & mask=8<dim), merge(size(x, 9), size(x, 10), mask=9<dim), merge(size(x, 10), size(x, 11), mask=10<dim), merge(size(x,&
            & 11), size(x, 12), mask=11<dim), merge(size(x, 12), size(x, 13), mask=12<dim), merge(size(x, 13), size(x, 14),&
            & mask=13<dim), merge(size(x, 14), size(x, 15), mask=14<dim))

        res = 0._dp
        select case(dim)
          case(1)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(i, :, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(2)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, i, :, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(3)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, i, :, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(4)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, i, :, :, :, :, :, :, :, :, :, :, :))
            end do
          case(5)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, i, :, :, :, :, :, :, :, :, :, :))
            end do
          case(6)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, i, :, :, :, :, :, :, :, :, :))
            end do
          case(7)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, i, :, :, :, :, :, :, :, :))
            end do
          case(8)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, i, :, :, :, :, :, :, :))
            end do
          case(9)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, i, :, :, :, :, :, :))
            end do
          case(10)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, i, :, :, :, :, :))
            end do
          case(11)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, i, :, :, :, :))
            end do
          case(12)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, i, :, :, :))
            end do
          case(13)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, i, :, :))
            end do
          case(14)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, i, :))
            end do
          case(15)
            n = count(mask, dim)
            mean = sum(real(x, dp), dim, mask) / n
            do i = 1, size(x, dim)
              res = res + merge((real(x(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i), dp) - mean)**2,&
                                  0._dp, mask(:, :, :, :, :, :, :, :, :, :, :, :, :, :, i))
            end do
          case default
            call error_stop("ERROR (var): wrong dimension")
        end select
        res = res / (n - merge(1, 0, (optval(corrected, .true.) .and. n > 0)))

      end function var_mask_15_iint64_dp

end submodule
